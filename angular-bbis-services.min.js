angular.module("bbis.api",[]).config(["$provide",function(n){n.decorator("$q",["$delegate",function(n){var t=n.defer;return n.defer=function(){var n=t();return n.promise.success=function(t){return n.promise.then(t),n.promise},n.promise.error=function(t){return n.promise.then(null,t),n.promise},n},n}])}]).factory("BbisApi",["QueryService","UserService","CountryService","CodeTableService","ImageService","DonationService",function(n,t,i,r,u,f){return{QueryService:n,UserService:t,CountryService:i,CodeTableService:r,ImageService:u,DonationService:f}}]).factory("QueryService",["$http","$q",function(n,t){function r(n){return n==="True"||n==="False"?n=n==="True":$.isNumeric(n)?n=parseFloat(n):Date.parse(n)&&(n=new Date(n)),n}var i=function(n){var t;typeof n=="string"?t=n:typeof n=="object"&&(t=n.url);t=t||BLACKBAUD.api.pageInformation.rootPath;this.baseUrl=t+"WebApi"};return i.prototype={getResults:function(t,i){var f,u,e,o,r,s=this.baseUrl+"/Query/"+t;if(i){for(r="",u=0;u<i.length;u++)e=i[u],f=e.columnName,o=e.value,f&&o&&(r.length>0&&(r+="&"),r+=encodeURIComponent(f)+"="+encodeURIComponent(o));r.length>0&&(s+="?"+r)}return n.get(s)},getResultsAsObjects:function(n,i,u){var f=t.defer();return this.getResults(n,i).success(function(n){var t=[],i=n.Fields,e=n.Rows;angular.forEach(e,function(n){for(var e={},f=0,o=n.Values.length;f<o;f++)e[i[f].Caption]=u?n.values[f]:r(n.Values[f]);t.push(e)});f.resolve(t)}),f.promise},getManyAsObjects:function(n,i){var u=this,r=t.defer(),f=$.map(i,function(t){return u.getResultsAsObjects(n,[t])});return t.all(f).then(function(n){var t=[];angular.forEach(n,function(n){t=t.concat(n)});r.resolve(t)}),r.promise}},i}]).factory("UserService",["$http","filterFilter","$q",function(n,t,i){var r=function(n){var t;typeof n=="string"?t=n:typeof n=="object"&&(t=n.url);t=t||BLACKBAUD.api.pageInformation.rootPath;this.baseUrl=t+"WebApi"};return r.prototype={getProfile:function(){return n.get(this.baseUrl+"/User")},getDonorProfile:function(){var n=i.defer();return this.getProfile().success(function(i){var r={Title:i.Title,FirstName:i.FirstName,LastName:i.LastName,Phone:i.Phone,Address:{}},f,u;i.EmailAddresses&&i.EmailAddresses.length&&(f=t(i.EmailAddresses,{IsPrimary:!0})[0],r.EmailAddress=f.EmailAddress);i.Addresses&&i.Addresses.length&&(u=t(i.Addresses,{IsPrimary:!0})[0],r.Address.StreetAddress=u.StreetAddress,r.Address.City=u.City,r.Address.State=u.State,r.Address.PostalCode=u.PostalCode,r.Address.Country=u.Country||"United States");n.resolve(r)}),n.promise}},r}]).factory("CountryService",["$http",function(n){var t=function(n){var t;typeof n=="string"?t=n:typeof n=="object"&&(t=n.url);t=t||BLACKBAUD.api.pageInformation.rootPath;this.baseUrl=t+"WebApi"};return t.prototype={getCountries:function(){return n.get(this.baseUrl+"/Country")},getStates:function(t){var i=this.baseUrl+"/Country/"+t+"/State";return n.get(i)},getAddressCaptions:function(t){var i=this.baseUrl+"/Country/"+t+"/AddressCaptions";return n.get(i)}},t}]).factory("CodeTableService",["$http",function(n){var t=function(n){var t;typeof n=="string"?t=n:typeof n=="object"&&(t=n.url);t=t||BLACKBAUD.api.pageInformation.rootPath;this.baseUrl=t+"WebApi"};return t.prototype={getEntries:function(t){var i=this.baseUrl+"/CodeTable/"+t;return n.get(i)}},t}]).factory("ImageService",["$http",function(n){var t=function(n){var t;typeof n=="string"?t=n:typeof n=="object"&&(t=n.url);t=t||BLACKBAUD.api.pageInformation.rootPath;this.baseUrl=t+"WebApi"};return t.prototype={getImagesByFolderGUID:function(t){var i=this.baseUrl+"/Images?FolderGUID="+encodeURIComponent(t);return n.get(i)},getImagesByTag:function(t){var i=this.baseUrl+"/Images?Tag="+encodeURIComponent(t);return n.get(i)},getImagesByFolder:function(t){var i=this.baseUrl+"/Images/"+encodeURIComponent(t);return n.get(i)}},t}]).factory("DonationService",["$http","$q",function(n,t){var i=function(n,t){var i;typeof t=="string"?i=t:typeof t=="object"&&(i=t.url);i=i||BLACKBAUD.api.pageInformation.rootPath;this.contextId=n;this.baseUrl=i+"WebApi/"+this.contextId+"/Donation"};return i.prototype={createDonation:function(t){var i=this.baseUrl+"/Create";return n.post(i,t).success(function(n){return n.BBSPCheckoutUri?location.href=n.BBSPCheckoutUri:n.PaymentPageUri&&(location.href=n.PaymentPageUri),n})},getDonation:function(t){var i=this.baseUrl+"/"+t;return n.get(i)},completeBBSPDonation:function(t){var i=this.baseUrl+"/"+t+"/CompleteBBSPDonation";return n.post(i)},getDonationConfirmationHtml:function(i){var r=t.defer(),u=this.baseUrl+"/"+i+"/ConfirmationHtml";return n.get(u).success(function(n){var t=n.replace(/\\n/g,"").replace(/\\t/g,"").replace(/\\/g,"").substring(1,n.length-1);r.resolve(t)}),r.promise}},i}]);
//# sourceMappingURL=angular-bbis-services.min.js.map
